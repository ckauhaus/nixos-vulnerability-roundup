# Vulnerability roundup 114: metabase-0.42.1: 3 advisories [8.8]

[search](https://search.nix.gsc.io/?q=metabase&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=metabase+in%3Apath&type=Code)

* [ ] [CVE-2022-24854](https://nvd.nist.gov/vuln/detail/CVE-2022-24854) CVSSv3=8.8 (nixos-unstable)
* [ ] [CVE-2022-24855](https://nvd.nist.gov/vuln/detail/CVE-2022-24855) CVSSv3=5.4 (nixos-unstable)
* [ ] [CVE-2022-24853](https://nvd.nist.gov/vuln/detail/CVE-2022-24853) CVSSv3=5.3 (nixos-unstable)

## CVE details

### CVE-2022-24854

Metabase is an open source business intelligence and analytics application. SQLite has an FDW-like feature called `ATTACH DATABASE`, which allows connecting multiple SQLite databases via the initial connection. If the attacker has SQL permissions to at least one SQLite database, then it can attach this database to a second database, and then it can query across all the tables. To be able to do that the attacker also needs to know the file path to the second database. Users are advised to upgrade as soon as possible. If you're unable to upgrade, you can modify your SQLIte connection strings to contain the url argument `?limit_attached=0`, which will disallow making connections to other SQLite databases. Only users making use of SQLite are affected.

### CVE-2022-24855

Metabase is an open source business intelligence and analytics application. In affected versions Metabase ships with an internal development endpoint `/_internal` that can allow for cross site scripting (XSS) attacks, potentially leading to phishing attempts with malicious links that could lead to account takeover. Users are advised to either upgrade immediately, or block access in your firewall to `/_internal` endpoints for Metabase. The following patches (or greater versions) are available: 0.42.4 and 1.42.4, 0.41.7 and 1.41.7, 0.40.8 and 1.40.8.

### CVE-2022-24853

Metabase is an open source business intelligence and analytics application. Metabase has a proxy to load arbitrary URLs for JSON maps as part of our GeoJSON support. While we do validation to not return contents of arbitrary URLs, there is a case where a particularly crafted request could result in file access on windows, which allows enabling an `NTLM relay attack`, potentially allowing an attacker to receive the system password hash. If you use Windows and are on this version of Metabase, please upgrade immediately. The following patches (or greater versions) are available: 0.42.4 and 1.42.4, 0.41.7 and 1.41.7, 0.40.8 and 1.40.8.

-----
Scanned versions: nixos-unstable: f419dc5763c.

Cc @mmahut
Cc @schneefux
Cc @thoughtpolice

