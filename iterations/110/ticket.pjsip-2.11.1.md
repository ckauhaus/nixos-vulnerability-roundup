# Vulnerability roundup 110: pjsip-2.11.1: 4 advisories [9.8]

[search](https://search.nix.gsc.io/?q=pjsip&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=pjsip+in%3Apath&type=Code)

* [ ] [CVE-2021-37706](https://nvd.nist.gov/vuln/detail/CVE-2021-37706) CVSSv3=9.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43845](https://nvd.nist.gov/vuln/detail/CVE-2021-43845) CVSSv3=9.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-41141](https://nvd.nist.gov/vuln/detail/CVE-2021-41141) CVSSv3=7.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43804](https://nvd.nist.gov/vuln/detail/CVE-2021-43804) CVSSv3=7.3 (nixos-21.11, nixos-unstable)

## CVE details

### CVE-2021-37706

PJSIP is a free and open source multimedia communication library written in C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. In affected versions if the incoming STUN message contains an ERROR-CODE attribute, the header length is not checked before performing a subtraction operation, potentially resulting in an integer underflow scenario. This issue affects all users that use STUN. A malicious actor located within the victim’s network may forge and send a specially crafted UDP (STUN) message that could remotely execute arbitrary code on the victim’s machine. Users are advised to upgrade as soon as possible. There are no known workarounds.

### CVE-2021-43845

PJSIP is a free and open source multimedia communication library. In version 2.11.1 and prior, if incoming RTCP XR message contain block, the data field is not checked against the received packet size, potentially resulting in an out-of-bound read access. This affects all users that use PJMEDIA and RTCP XR. A malicious actor can send a RTCP XR message with an invalid packet size.

### CVE-2021-41141

PJSIP is a free and open source multimedia communication library written in the C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. In various parts of PJSIP, when error/failure occurs, it is found that the function returns without releasing the currently held locks. This could result in a system deadlock, which cause a denial of service for the users. No release has yet been made which contains the linked fix commit. All versions up to an including 2.11.1 are affected. Users may need to manually apply the patch.

### CVE-2021-43804

PJSIP is a free and open source multimedia communication library written in C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. In affected versions if the incoming RTCP BYE message contains a reason's length, this declared length is not checked against the actual received packet size, potentially resulting in an out-of-bound read access. This issue affects all users that use PJMEDIA and RTCP. A malicious actor can send a RTCP BYE message with an invalid reason length. Users are advised to upgrade as soon as possible. There are no known workarounds.

-----
Scanned versions: nixos-21.11: 3ddd960a3b5; nixos-unstable: 5aaed40d22f.

Cc @olynch

