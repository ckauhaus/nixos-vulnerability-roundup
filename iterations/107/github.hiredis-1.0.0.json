{
  "ticket": {
    "iteration": 107,
    "pkg": "hiredis-1.0.0",
    "affected": {
      "CVE-2021-32765": {
        "branches": [
          {
            "name": "nixos-21.05",
            "rev": "3b1789322fcbcb5cf51228d732752714f1bf77da"
          },
          {
            "name": "nixos-unstable",
            "rev": "34ad3ffe08adfca17fcb4e4a47bb5f3b113687be"
          }
        ],
        "score": 8.8,
        "description": "Hiredis is a minimalistic C client library for the Redis database. In affected versions Hiredis is vulnurable to integer overflow if provided maliciously crafted or corrupted `RESP` `mult-bulk` protocol data. When parsing `multi-bulk` (array-like) replies, hiredis fails to check if `count * sizeof(redisReply*)` can be represented in `SIZE_MAX`. If it can not, and the `calloc()` call doesn't itself make this check, it would result in a short allocation and subsequent buffer overflow. Users of hiredis who are unable to update may set the [maxelements](https://github.com/redis/hiredis#reader-max-array-elements) context option to a value small enough that no overflow is possible."
      }
    },
    "maintainers": []
  },
  "issue_id": 142975,
  "issue_url": "https://api.github.com/repos/NixOS/nixpkgs/issues/142975"
}
