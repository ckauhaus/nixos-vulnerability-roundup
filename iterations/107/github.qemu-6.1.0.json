{
  "ticket": {
    "iteration": 107,
    "pkg": "qemu-6.1.0",
    "affected": {
      "CVE-2021-3682": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "34ad3ffe08adfca17fcb4e4a47bb5f3b113687be"
          }
        ],
        "score": 8.5,
        "description": "A flaw was found in the USB redirector device emulation of QEMU in versions prior to 6.1.0-rc2. It occurs when dropping packets during a bulk transfer from a SPICE client due to the packet queue being full. A malicious SPICE client could use this flaw to make QEMU call free() with faked heap chunk metadata, resulting in a crash of QEMU or potential code execution with the privileges of the QEMU process on the host."
      },
      "CVE-2021-3527": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "34ad3ffe08adfca17fcb4e4a47bb5f3b113687be"
          }
        ],
        "score": 5.5,
        "description": "A flaw was found in the USB redirector device (usb-redir) of QEMU. Small USB packets are combined into a single, large transfer request, to reduce the overhead and improve performance. The combined size of the bulk transfer is used to dynamically allocate a variable length array (VLA) on the stack without proper validation. Since the total size is not bounded, a malicious guest could use this flaw to influence the array length and cause the QEMU process to perform an excessive allocation on the stack, resulting in a denial of service."
      },
      "CVE-2021-3713": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "34ad3ffe08adfca17fcb4e4a47bb5f3b113687be"
          }
        ],
        "score": 7.4,
        "description": "An out-of-bounds write flaw was found in the UAS (USB Attached SCSI) device emulation of QEMU in versions prior to 6.2.0-rc0. The device uses the guest supplied stream number unchecked, which can lead to out-of-bounds access to the UASDevice->data3 and UASDevice->status3 fields. A malicious guest user could use this flaw to crash QEMU or potentially achieve code execution with the privileges of the QEMU process on the host."
      }
    },
    "maintainers": [
      {
        "github": "alyssais",
        "email": "hi@alyssa.is"
      },
      {
        "github": "edolstra",
        "email": "edolstra+nixpkgs@gmail.com"
      }
    ]
  },
  "issue_id": 143003,
  "issue_url": "https://api.github.com/repos/NixOS/nixpkgs/issues/143003"
}
