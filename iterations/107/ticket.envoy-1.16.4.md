# Vulnerability roundup 107: envoy-1.16.4: 3 advisories [8.6]

[search](https://search.nix.gsc.io/?q=envoy&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=envoy+in%3Apath&type=Code)

* [ ] [CVE-2021-39162](https://nvd.nist.gov/vuln/detail/CVE-2021-39162) CVSSv3=8.6 (nixos-21.05)
* [ ] [CVE-2021-39206](https://nvd.nist.gov/vuln/detail/CVE-2021-39206) CVSSv3=8.6 (nixos-21.05)
* [ ] [CVE-2021-39204](https://nvd.nist.gov/vuln/detail/CVE-2021-39204) CVSSv3=7.5 (nixos-21.05)

## CVE details

### CVE-2021-39162

Pomerium is an open source identity-aware access proxy. Envoy, which Pomerium is based on, can abnormally terminate if an H/2 GOAWAY and SETTINGS frame are received in the same IO event. This can lead to a DoS in the presence of untrusted *upstream* servers. 0.15.1 contains an upgraded envoy binary with this vulnerability patched. If only trusted upstreams are configured, there is not substantial risk of this condition being triggered.

### CVE-2021-39206

Pomerium is an open source identity-aware access proxy. Envoy, which Pomerium is based on, contains two authorization related vulnerabilities CVE-2021-32777 and CVE-2021-32779. This may lead to incorrect routing or authorization policy decisions. With specially crafted requests, incorrect authorization or routing decisions may be made by Pomerium. Pomerium v0.14.8 and v0.15.1 contain an upgraded envoy binary with these vulnerabilities patched. This issue can only be triggered when using path prefix based policy. Removing any such policies should provide mitigation.

### CVE-2021-39204

Pomerium is an open source identity-aware access proxy. Envoy, which Pomerium is based on, incorrectly handles resetting of HTTP/2 streams with excessive complexity. This can lead to high CPU utilization when a large number of streams are reset. This can result in a DoS condition. Pomerium versions 0.14.8 and 0.15.1 contain an upgraded envoy binary with this vulnerability patched.

-----
Scanned versions: nixos-21.05: 3b1789322fc.

Cc @lukegb

