# Vulnerability roundup 109: mediawiki-1.35.4: 16 advisories [9.8]

[search](https://search.nix.gsc.io/?q=mediawiki&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=mediawiki+in%3Apath&type=Code)

* [ ] [CVE-2021-36126](https://nvd.nist.gov/vuln/detail/CVE-2021-36126) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-36128](https://nvd.nist.gov/vuln/detail/CVE-2021-36128) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-36132](https://nvd.nist.gov/vuln/detail/CVE-2021-36132) CVSSv3=8.8 (nixos-21.05)
* [ ] [CVE-2021-36125](https://nvd.nist.gov/vuln/detail/CVE-2021-36125) CVSSv3=7.5 (nixos-21.05)
* [ ] [CVE-2021-41799](https://nvd.nist.gov/vuln/detail/CVE-2021-41799) CVSSv3=7.5 (nixos-21.05)
* [ ] [CVE-2021-42040](https://nvd.nist.gov/vuln/detail/CVE-2021-42040) CVSSv3=7.5 (nixos-21.05)
* [ ] [CVE-2021-41798](https://nvd.nist.gov/vuln/detail/CVE-2021-41798) CVSSv3=6.1 (nixos-21.05)
* [ ] [CVE-2021-42041](https://nvd.nist.gov/vuln/detail/CVE-2021-42041) CVSSv3=6.1 (nixos-21.05)
* [ ] [CVE-2021-42043](https://nvd.nist.gov/vuln/detail/CVE-2021-42043) CVSSv3=6.1 (nixos-21.05)
* [ ] [CVE-2021-41800](https://nvd.nist.gov/vuln/detail/CVE-2021-41800) CVSSv3=5.3 (nixos-21.05)
* [ ] [CVE-2021-36130](https://nvd.nist.gov/vuln/detail/CVE-2021-36130) CVSSv3=4.8 (nixos-21.05)
* [ ] [CVE-2021-36131](https://nvd.nist.gov/vuln/detail/CVE-2021-36131) CVSSv3=4.8 (nixos-21.05)
* [ ] [CVE-2021-42042](https://nvd.nist.gov/vuln/detail/CVE-2021-42042) CVSSv3=4.8 (nixos-21.05)
* [ ] [CVE-2021-42044](https://nvd.nist.gov/vuln/detail/CVE-2021-42044) CVSSv3=4.8 (nixos-21.05)
* [ ] [CVE-2021-36127](https://nvd.nist.gov/vuln/detail/CVE-2021-36127) CVSSv3=4.3 (nixos-21.05)
* [ ] [CVE-2021-36129](https://nvd.nist.gov/vuln/detail/CVE-2021-36129) CVSSv3=4.3 (nixos-21.05)

## CVE details

### CVE-2021-36126

An issue was discovered in the AbuseFilter extension in MediaWiki through 1.36. If the MediaWiki:Abusefilter-blocker message is invalid within the content language, the filter user falls back to the English version, but that English version could also be invalid on a wiki. This would result in a fatal error, and potentially fail to block or restrict a potentially nefarious user.

### CVE-2021-36128

An issue was discovered in the CentralAuth extension in MediaWiki through 1.36. Autoblocks for CentralAuth-issued suppression blocks are not properly implemented.

### CVE-2021-36132

An issue was discovered in the FileImporter extension in MediaWiki through 1.36. For certain relaxed configurations of the $wgFileImporterRequiredRight variable, it might not validate all appropriate user rights, thus allowing a user with insufficient rights to perform operations (specifically file uploads) that they should not be allowed to perform.

### CVE-2021-36125

An issue was discovered in the CentralAuth extension in MediaWiki through 1.36. The Special:GlobalRenameRequest page is vulnerable to infinite loops and denial of service attacks when a user's current username is beyond an arbitrary maximum configuration value (MaxNameChars).

### CVE-2021-41799

MediaWiki before 1.36.2 allows a denial of service (resource consumption because of lengthy query processing time). ApiQueryBacklinks (action=query&list=backlinks) can cause a full table scan.

### CVE-2021-42040

An issue was discovered in MediaWiki through 1.36.2. A parser function related to loop control allowed for an infinite loop (and php-fpm hang) within the Loops extension because egLoopsCountLimit is mishandled. This could lead to memory exhaustion.

### CVE-2021-41798

MediaWiki before 1.36.2 allows XSS. Month related MediaWiki messages are not escaped before being used on the Special:Search results page.

### CVE-2021-42041

An issue was discovered in CentralAuth in MediaWiki through 1.36.2. The rightsnone MediaWiki message was not being properly sanitized and allowed for the injection and execution of HTML and JavaScript via the setchange log.

### CVE-2021-42043

An issue was discovered in Special:MediaSearch in the MediaSearch extension in MediaWiki through 1.36.2. The suggestion text (a parameter to mediasearch-did-you-mean) was not being properly sanitized and allowed for the injection and execution of HTML and JavaScript via the intitle: search operator within the query.

### CVE-2021-41800

MediaWiki before 1.36.2 allows a denial of service (resource consumption because of lengthy query processing time). Visiting Special:Contributions can sometimes result in a long running SQL query because PoolCounter protection is mishandled.

### CVE-2021-36130

An XSS issue was discovered in the SocialProfile extension in MediaWiki through 1.36. Within several gift-related special pages, a privileged user with the awardmanage right could inject arbitrary HTML and JavaScript within various gift-related data fields. The attack could easily propagate across many pages for many users.

### CVE-2021-36131

An XSS issue was discovered in the SportsTeams extension in MediaWiki through 1.36. Within several special pages, a privileged user could inject arbitrary HTML and JavaScript within various data fields. The attack could easily propagate across many pages for many users.

### CVE-2021-42042

An issue was discovered in SpecialEditGrowthConfig in the GrowthExperiments extension in MediaWiki through 1.36.2. The growthexperiments-edit-config-error-invalid-title MediaWiki message was not being properly sanitized and allowed for the injection and execution of HTML and JavaScript.

### CVE-2021-42044

An issue was discovered in the Mentor dashboard in the GrowthExperiments extension in MediaWiki through 1.36.2. The Growthexperiments-mentor-dashboard-mentee-overview-add-filter-total-edits-headline, growthexperiments-mentor-dashboard-mentee-overview-add-filter-starred-headline, growthexperiments-mentor-dashboard-mentee-overview-info-text, growthexperiments-mentor-dashboard-mentee-overview-info-legend-headline, and growthexperiments-mentor-dashboard-mentee-overview-active-ago MediaWiki messages were not being properly sanitized and allowed for the injection and execution of HTML and JavaScript.

### CVE-2021-36127

An issue was discovered in the CentralAuth extension in MediaWiki through 1.36. The Special:GlobalUserRights page provided search results which, for a suppressed MediaWiki user, were different than for any other user, thus easily disclosing suppressed accounts (which are supposed to be completely hidden).

### CVE-2021-36129

An issue was discovered in the Translate extension in MediaWiki through 1.36. The Aggregategroups Action API module does not validate the parameter for aggregategroup when action=remove is set, thus allowing users with the translate-manage right to silently delete various groups' metadata.

-----
Scanned versions: nixos-21.05: 3b422991781.

Cc @redvers

