# Vulnerability roundup 109: oh-my-zsh-2021-04-26: 4 advisories [9.8]

[search](https://search.nix.gsc.io/?q=oh-my-zsh&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=oh-my-zsh+in%3Apath&type=Code)

* [ ] [CVE-2021-3726](https://nvd.nist.gov/vuln/detail/CVE-2021-3726) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-3727](https://nvd.nist.gov/vuln/detail/CVE-2021-3727) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-3769](https://nvd.nist.gov/vuln/detail/CVE-2021-3769) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-3934](https://nvd.nist.gov/vuln/detail/CVE-2021-3934) CVSSv3=7.5 (nixos-21.05)

## CVE details

### CVE-2021-3726

# Vulnerability in `title` function **Description**: the `title` function defined in `lib/termsupport.zsh` uses `print` to set the terminal title to a user-supplied string. In Oh My Zsh, this function is always used securely, but custom user code could use the `title` function in a way that is unsafe. **Fixed in**: [a263cdac](https://github.com/ohmyzsh/ohmyzsh/commit/a263cdac). **Impacted areas**: - `title` function in `lib/termsupport.zsh`. - Custom user code using the `title` function.

### CVE-2021-3727

# Vulnerability in `rand-quote` and `hitokoto` plugins **Description**: the `rand-quote` and `hitokoto` fetch quotes from quotationspage.com and hitokoto.cn respectively, do some process on them and then use `print -P` to print them. If these quotes contained the proper symbols, they could trigger command injection. Given that they're an external API, it's not possible to know if the quotes are safe to use. **Fixed in**: [72928432](https://github.com/ohmyzsh/ohmyzsh/commit/72928432). **Impacted areas**: - `rand-quote` plugin (`quote` function). - `hitokoto` plugin (`hitokoto` function).

### CVE-2021-3769

# Vulnerability in `pygmalion`, `pygmalion-virtualenv` and `refined` themes **Description**: these themes use `print -P` on user-supplied strings to print them to the terminal. All of them do that on git information, particularly the branch name, so if the branch has a specially-crafted name the vulnerability can be exploited. **Fixed in**: [b3ba9978](https://github.com/ohmyzsh/ohmyzsh/commit/b3ba9978). **Impacted areas**: - `pygmalion` theme. - `pygmalion-virtualenv` theme. - `refined` theme.

### CVE-2021-3934

ohmyzsh is vulnerable to Improper Neutralization of Special Elements used in an OS Command

-----
Scanned versions: nixos-21.05: 3b422991781.

Cc @nequissimus

