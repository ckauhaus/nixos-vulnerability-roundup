{
  "ticket": {
    "iteration": 111,
    "pkg": "tensorflow-2.7.0",
    "affected": {
      "CVE-2022-21730": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.1,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `FractionalAvgPoolGrad` does not consider cases where the input tensors are invalid allowing an attacker to read from outside of bounds of heap. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21733": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `StringNGrams` can be used to trigger a denial of service attack by causing an out of memory condition after an integer overflow. We are missing a validation on `pad_witdh` and that result in computing a negative value for `ngram_width` which is later used to allocate parts of the output. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21732": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `ThreadPoolHandle` can be used to trigger a denial of service attack by allocating too much memory. This is because the `num_threads` argument is only checked to not be negative, but there is no upper bound on its value. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23560": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would allow limited reads and writes outside of arrays in TFLite. This exploits missing validation in the conversion from sparse tensors to dense tensors. The fix is included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range. Users are advised to upgrade as soon as possible."
      },
      "CVE-2022-21741": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. ### Impact An attacker can craft a TFLite model that would trigger a division by zero in the implementation of depthwise convolutions. The parameters of the convolution can be user controlled and are also used within a division operation to determine the size of the padding that needs to be added before applying the convolution. There is no check before this division that the divisor is strictly positive. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23577": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `GetInitOp` is vulnerable to a crash caused by dereferencing a null pointer. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23581": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The Grappler optimizer in TensorFlow can be used to cause a denial of service by altering a `SavedModel` such that `IsSimplifiableReshape` would trigger `CHECK` failures. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21738": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `SparseCountSparseOutput` can be made to crash a TensorFlow process by an integer overflow whose result is then used in a memory allocation. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21725": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The estimator for the cost of some convolution operations can be made to execute a division by 0. The function fails to check that the stride argument is strictly positive. Hence, the fix is to add a check for the stride argument to ensure it is valid. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23572": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. Under certain scenarios, TensorFlow can fail to specialize a type during shape inference. This case is covered by the `DCHECK` function however, `DCHECK` is a no-op in production builds and an assertion failure in debug builds. In the first case execution proceeds to the `ValueOrDie` line. This results in an assertion failure as `ret` contains an error `Status`, not a value. In the second case we also get a crash due to the assertion failure. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, and TensorFlow 2.6.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23583": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A malicious user can cause a denial of service by altering a `SavedModel` such that any binary op would trigger `CHECK` failures. This occurs when the protobuf part corresponding to the tensor arguments is modified such that the `dtype` no longer matches the `dtype` expected by the op. In that case, calling the templated binary operator for the binary op would receive corrupted data, due to the type confusion involved. If `Tin` and `Tout` don't match the type of data in `out` and `input_*` tensors then `flat<*>` would interpret it wrongly. In most cases, this would be a silent failure, but we have noticed scenarios where this results in a `CHECK` crash, hence a denial of service. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23573": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `AssignOp` can result in copying uninitialized data to a new tensor. This later results in undefined behavior. The implementation has a check that the left hand side of the assignment is initialized (to minimize number of allocations), but does not check that the right hand side is also initialized. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21726": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `Dequantize` does not fully validate the value of `axis` and can result in heap OOB accesses. The `axis` argument can be `-1` (the default value for the optional argument) or any other positive value at most the number of dimensions of the input. Unfortunately, the upper bound is not checked and this results in reading past the end of the array containing the dimensions of the input tensor. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23557": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would trigger a division by zero in `BiasAndClamp` implementation. There is no check that the `bias_size` is non zero. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23582": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A malicious user can cause a denial of service by altering a `SavedModel` such that `TensorByteSize` would trigger `CHECK` failures. `TensorShape` constructor throws a `CHECK`-fail if shape is partial or has a number of elements that would overflow the size of an `int`. The `PartialTensorShape` constructor instead does not cause a `CHECK`-abort if the shape is partial, which is exactly what this function needs to be able to return `-1`. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23587": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 9.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. Under certain scenarios, Grappler component of TensorFlow is vulnerable to an integer overflow during cost estimation for crop and resize. Since the cropping parameters are user controlled, a malicious person can trigger undefined behavior. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23568": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `AddManySparseToTensorsMap` is vulnerable to an integer overflow which results in a `CHECK`-fail when building new `TensorShape` objects (so, an assert failure based denial of service). We are missing some validation on the shapes of the input tensors as well as directly constructing a large `TensorShape` with user-provided dimensions. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23591": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 7.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The `GraphDef` format in TensorFlow does not allow self recursive functions. The runtime assumes that this invariant is satisfied. However, a `GraphDef` containing a fragment such as the following can be consumed when loading a `SavedModel`. This would result in a stack overflow during execution as resolving each `NodeDef` means resolving the function itself and its nodes. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23594": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 5.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The TFG dialect of TensorFlow (MLIR) makes several assumptions about the incoming `GraphDef` before converting it to the MLIR-based dialect. If an attacker changes the `SavedModel` format on disk to invalidate these assumptions and the `GraphDef` is then converted to MLIR-based IR then they can cause a crash in the Python interpreter. Under certain scenarios, heap OOB read/writes are possible. These issues have been discovered via fuzzing and it is possible that more weaknesses exist. We will patch them as they are discovered."
      },
      "CVE-2022-23566": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. TensorFlow is vulnerable to a heap OOB write in `Grappler`. The `set_output` function writes to an array at the specified index. Hence, this gives a malicious user a write primitive. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21737": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `*Bincount` operations allows malicious users to cause denial of service by passing in arguments which would trigger a `CHECK`-fail. There are several conditions that the input arguments must satisfy. Some are not caught during shape inference and others are not caught during kernel implementation. This results in `CHECK` failures later when the output tensors get allocated. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23561": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would cause a write outside of bounds of an array in TFLite. In fact, the attacker can override the linked list used by the memory allocator. This can be leveraged for an arbitrary write primitive under certain conditions. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23563": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.3,
        "description": "Tensorflow is an Open Source Machine Learning Framework. In multiple places, TensorFlow uses `tempfile.mktemp` to create temporary files. While this is acceptable in testing, in utilities and libraries it is dangerous as a different process can create the file between the check for the filename in `mktemp` and the actual creation of the file by a subsequent operation (a TOC/TOU type of weakness). In several instances, TensorFlow was supposed to actually create a temporary directory instead of a file. This logic bug is hidden away by the `mktemp` function usage. We have patched the issue in several commits, replacing `mktemp` with the safer `mkstemp`/`mkdtemp` functions, according to the usage pattern. Users are advised to upgrade as soon as possible."
      },
      "CVE-2022-23592": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.1,
        "description": "Tensorflow is an Open Source Machine Learning Framework. TensorFlow's type inference can cause a heap out of bounds read as the bounds checking is done in a `DCHECK` (which is a no-op during production). An attacker can control the `input_idx` variable such that `ix` would be larger than the number of values in `node_t.args`. The fix will be included in TensorFlow 2.8.0. This is the only affected version."
      },
      "CVE-2022-23562": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `Range` suffers from integer overflows. These can trigger undefined behavior or, in some scenarios, extremely large allocations. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23574": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. There is a typo in TensorFlow's `SpecializeType` which results in heap OOB read/write. Due to a typo, `arg` is initialized to the `i`th mutable argument in a loop where the loop index is `j`. Hence it is possible to assign to `arg` from outside the vector of arguments. Since this is a mutable proto value, it allows both read and write to outside of bounds data. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, and TensorFlow 2.6.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23576": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `OpLevelCostEstimator::CalculateOutputSize` is vulnerable to an integer overflow if an attacker can create an operation which would involve tensors with large enough number of elements. We can have a large enough number of dimensions in `output_shape.dim()` or just a small number of dimensions being large enough to cause an overflow in the multiplication. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21729": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `UnravelIndex` is vulnerable to a division by zero caused by an integer overflow bug. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21739": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `QuantizedMaxPool` has an undefined behavior where user controlled inputs can trigger a reference binding to null pointer. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23559": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would cause an integer overflow in embedding lookup operations. Both `embedding_size` and `lookup_size` are products of values provided by the user. Hence, a malicious user could trigger overflows in the multiplication. In certain scenarios, this can then result in heap OOB read/write. Users are advised to upgrade to a patched version."
      },
      "CVE-2022-23590": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 7.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A `GraphDef` from a TensorFlow `SavedModel` can be maliciously altered to cause a TensorFlow process to crash due to encountering a `StatusOr` value that is an error and forcibly extracting the value from it. We have patched the issue in multiple GitHub commits and these will be included in TensorFlow 2.8.0 and TensorFlow 2.7.1, as both are affected."
      },
      "CVE-2022-23558": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would cause an integer overflow in `TfLiteIntArrayCreate`. The `TfLiteIntArrayGetSizeInBytes` returns an `int` instead of a `size_t. An attacker can control model inputs such that `computed_size` overflows the size of `int` datatype. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21727": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of shape inference for `Dequantize` is vulnerable to an integer overflow weakness. The `axis` argument can be `-1` (the default value for the optional argument) or any other positive value at most the number of dimensions of the input. Unfortunately, the upper bound is not checked, and, since the code computes `axis + 1`, an attacker can trigger an integer overflow. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23579": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The Grappler optimizer in TensorFlow can be used to cause a denial of service by altering a `SavedModel` such that `SafeToRemoveIdentity` would trigger `CHECK` failures. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23580": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. During shape inference, TensorFlow can allocate a large vector based on a value from a tensor controlled by the user. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23575": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `OpLevelCostEstimator::CalculateTensorSize` is vulnerable to an integer overflow if an attacker can create an operation which would involve a tensor with large enough number of elements. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21734": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `MapStage` is vulnerable a `CHECK`-fail if the key tensor is not a scalar. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21740": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.8,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `SparseCountSparseOutput` is vulnerable to a heap overflow. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23571": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. When decoding a tensor from protobuf, a TensorFlow process can encounter cases where a `CHECK` assertion is invalidated based on user controlled arguments, if the tensors have an invalid `dtype` and 0 elements or an invalid shape. This allows attackers to cause denial of services in TensorFlow processes. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23569": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. Multiple operations in TensorFlow can be used to trigger a denial of service via `CHECK`-fails (i.e., assertion failures). This is similar to TFSA-2021-198 and has similar fixes. We have patched the reported issues in multiple GitHub commits. It is possible that other similar instances exist in TensorFlow, we will issue fixes as these are discovered. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23567": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementations of `Sparse*Cwise*` ops are vulnerable to integer overflows. These can be used to trigger large allocations (so, OOM based denial of service) or `CHECK`-fails when building new `TensorShape` objects (so, assert failures based denial of service). We are missing some validation on the shapes of the input tensors as well as directly constructing a large `TensorShape` with user-provided dimensions. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21735": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `FractionalMaxPool` can be made to crash a TensorFlow process via a division by 0. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23589": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. Under certain scenarios, Grappler component of TensorFlow can trigger a null pointer dereference. There are 2 places where this can occur, for the same malicious alteration of a `SavedModel` file (fixing the first one would trigger the same dereference in the second place). First, during constant folding, the `GraphDef` might not have the required nodes for the binary operation. If a node is missing, the correposning `mul_*child` would be null, and the dereference in the subsequent line would be incorrect. We have a similar issue during `IsIdentityConsumingSwitch`. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23565": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can trigger denial of service via assertion failure by altering a `SavedModel` on disk such that `AttrDef`s of some operation are duplicated. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21731": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of shape inference for `ConcatV2` can be used to trigger a denial of service attack via a segfault caused by a type confusion. The `axis` argument is translated into `concat_dim` in the `ConcatShapeHelper` helper function. Then, a value for `min_rank` is computed based on `concat_dim`. This is then used to validate that the `values` tensor has at least the required rank. However, `WithRankAtLeast` receives the lower bound as a 64-bits value and then compares it against the maximum 32-bits integer value that could be represented. Due to the fact that `min_rank` is a 32-bits value and the value of `axis`, the `rank` argument is a negative value, so the error check is bypassed. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23584": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A malicious user can cause a use after free behavior when decoding PNG images. After `png::CommonFreeDecode(&decode)` gets called, the values of `decode.width` and `decode.height` are in an unspecified state. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23585": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. When decoding PNG images TensorFlow can produce a memory leak if the image is invalid. After calling `png::CommonInitDecode(..., &decode)`, the `decode` value contains allocated buffers which can only be freed by calling `png::CommonFreeDecode(&decode)`. However, several error case in the function implementation invoke the `OP_REQUIRES` macro which immediately terminates the execution of the function, without allowing for the memory free to occur. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23586": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A malicious user can cause a denial of service by altering a `SavedModel` such that assertions in `function.cc` would be falsified and crash the Python interpreter. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21736": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of `SparseTensorSliceDataset` has an undefined behavior: under certain condition it can be made to dereference a `nullptr` value. The 3 input arguments to `SparseTensorSliceDataset` represent a sparse tensor. However, there are some preconditions that these arguments must satisfy but these are not validated in the implementation. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-21728": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 8.1,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The implementation of shape inference for `ReverseSequence` does not fully validate the value of `batch_dim` and can result in a heap OOB read. There is a check to make sure the value of `batch_dim` does not go over the rank of the input, but there is no check for negative values. Negative dimensions are allowed in some cases to mimic Python's negative indexing (i.e., indexing from the end of the array), however if the value is too negative then the implementation of `Dim` would access elements before the start of an array. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23570": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. When decoding a tensor from protobuf, TensorFlow might do a null-dereference if attributes of some mutable arguments to some operations are missing from the proto. This is guarded by a `DCHECK`. However, `DCHECK` is a no-op in production builds and an assertion failure in debug builds. In the first case execution proceeds to the dereferencing of the null pointer, whereas in the second case it results in a crash due to the assertion failure. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, and TensorFlow 2.6.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23578": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 4.3,
        "description": "Tensorflow is an Open Source Machine Learning Framework. If a graph node is invalid, TensorFlow can leak memory in the implementation of `ImmutableExecutorState::Initialize`. Here, we set `item->kernel` to `nullptr` but it is a simple `OpKernel*` pointer so the memory that was previously allocated to it would leak. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23564": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. When decoding a resource handle tensor from protobuf, a TensorFlow process can encounter cases where a `CHECK` assertion is invalidated based on user controlled arguments. This allows attackers to cause denial of services in TensorFlow processes. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23588": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. A malicious user can cause a denial of service by altering a `SavedModel` such that Grappler optimizer would attempt to build a tensor using a reference `dtype`. This would result in a crash due to a `CHECK`-fail in the `Tensor` constructor as reference types are not allowed. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      },
      "CVE-2022-23593": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 7.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. The `simplifyBroadcast` function in the MLIR-TFRT infrastructure in TensorFlow is vulnerable to a segfault (hence, denial of service), if called with scalar shapes. If all shapes are scalar, then `maxRank` is 0, so we build an empty `SmallVector`. The fix will be included in TensorFlow 2.8.0. This is the only affected version."
      },
      "CVE-2022-23595": {
        "branches": [
          {
            "name": "nixos-unstable",
            "rev": "5aaed40d22f0d9376330b6fa413223435ad6fee5"
          }
        ],
        "score": 6.5,
        "description": "Tensorflow is an Open Source Machine Learning Framework. When building an XLA compilation cache, if default settings are used, TensorFlow triggers a null pointer dereference. In the default scenario, all devices are allowed, so `flr->config_proto` is `nullptr`. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range."
      }
    },
    "maintainers": [
      {
        "github": "abbradar",
        "email": "ab@fmap.me"
      },
      {
        "github": "jyp",
        "email": "jeanphilippe.bernardy@gmail.com"
      }
    ]
  },
  "issue_id": 160715,
  "issue_url": "https://api.github.com/repos/NixOS/nixpkgs/issues/160715"
}
