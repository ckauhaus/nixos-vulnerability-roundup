# Vulnerability roundup 108: jenkins-2.303.1: 13 advisories [9.8]

[search](https://search.nix.gsc.io/?q=jenkins&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=jenkins+in%3Apath&type=Code)

* [ ] [CVE-2021-21690](https://nvd.nist.gov/vuln/detail/CVE-2021-21690) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21691](https://nvd.nist.gov/vuln/detail/CVE-2021-21691) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21692](https://nvd.nist.gov/vuln/detail/CVE-2021-21692) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21693](https://nvd.nist.gov/vuln/detail/CVE-2021-21693) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21694](https://nvd.nist.gov/vuln/detail/CVE-2021-21694) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21696](https://nvd.nist.gov/vuln/detail/CVE-2021-21696) CVSSv3=9.8 (nixos-21.05)
* [ ] [CVE-2021-21685](https://nvd.nist.gov/vuln/detail/CVE-2021-21685) CVSSv3=9.1 (nixos-21.05)
* [ ] [CVE-2021-21687](https://nvd.nist.gov/vuln/detail/CVE-2021-21687) CVSSv3=9.1 (nixos-21.05)
* [ ] [CVE-2021-21689](https://nvd.nist.gov/vuln/detail/CVE-2021-21689) CVSSv3=9.1 (nixos-21.05)
* [ ] [CVE-2021-21697](https://nvd.nist.gov/vuln/detail/CVE-2021-21697) CVSSv3=9.1 (nixos-21.05)
* [ ] [CVE-2021-21695](https://nvd.nist.gov/vuln/detail/CVE-2021-21695) CVSSv3=8.8 (nixos-21.05)
* [ ] [CVE-2021-21686](https://nvd.nist.gov/vuln/detail/CVE-2021-21686) CVSSv3=8.1 (nixos-21.05)
* [ ] [CVE-2021-21688](https://nvd.nist.gov/vuln/detail/CVE-2021-21688) CVSSv3=7.5 (nixos-21.05)

## CVE details

### CVE-2021-21690

Agent processes are able to completely bypass file path filtering by wrapping the file operation in an agent file path in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21691

Creating symbolic links is possible without the 'symlink' agent-to-controller access control permission in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21692

FilePath#renameTo and FilePath#moveAllChildrenTo in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier only check 'read' agent-to-controller access permission on the source path, instead of 'delete'.

### CVE-2021-21693

When creating temporary files, agent-to-controller access to create those files is only checked after they've been created in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21694

FilePath#toURI, FilePath#hasSymlink, FilePath#absolutize, FilePath#isDescendant, and FilePath#get*DiskSpace do not check any permissions in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21696

Jenkins 2.318 and earlier, LTS 2.303.2 and earlier does not limit agent read/write access to the libs/ directory inside build directories when using the FilePath APIs, allowing attackers in control of agent processes to replace the code of a trusted library with a modified variant. This results in unsandboxed code execution in the Jenkins controller process.

### CVE-2021-21685

Jenkins 2.318 and earlier, LTS 2.303.2 and earlier does not check agent-to-controller access to create parent directories in FilePath#mkdirs.

### CVE-2021-21687

Jenkins 2.318 and earlier, LTS 2.303.2 and earlier does not check agent-to-controller access to create symbolic links when unarchiving a symbolic link in FilePath#untar.

### CVE-2021-21689

FilePath#unzip and FilePath#untar were not subject to any agent-to-controller access control in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21697

Jenkins 2.318 and earlier, LTS 2.303.2 and earlier allows any agent to read and write the contents of any build directory stored in Jenkins with very few restrictions.

### CVE-2021-21695

FilePath#listFiles lists files outside directories that agents are allowed to access when following symbolic links in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier.

### CVE-2021-21686

File path filters in the agent-to-controller security subsystem of Jenkins 2.318 and earlier, LTS 2.303.2 and earlier do not canonicalize paths, allowing operations to follow symbolic links to outside allowed directories.

### CVE-2021-21688

The agent-to-controller security check FilePath#reading(FileVisitor) in Jenkins 2.318 and earlier, LTS 2.303.2 and earlier does not reject any operations, allowing users to have unrestricted read access using certain operations (creating archives, FilePath#copyRecursiveTo).

-----
Scanned versions: nixos-21.05: 4f37689c8a2.

Cc @coreyoconnor
Cc @earldouglas
Cc @fpletz
Cc @nequissimus

