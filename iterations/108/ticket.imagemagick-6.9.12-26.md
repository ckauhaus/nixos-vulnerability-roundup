# Vulnerability roundup 108: imagemagick-6.9.12-26: 16 advisories [9.8]

[search](https://search.nix.gsc.io/?q=imagemagick&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=imagemagick+in%3Apath&type=Code)

* [ ] [CVE-2016-5841](https://nvd.nist.gov/vuln/detail/CVE-2016-5841) CVSSv3=9.8 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2018-16328](https://nvd.nist.gov/vuln/detail/CVE-2018-16328) CVSSv3=9.8 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2018-16329](https://nvd.nist.gov/vuln/detail/CVE-2018-16329) CVSSv3=9.8 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2019-17547](https://nvd.nist.gov/vuln/detail/CVE-2019-17547) CVSSv3=8.8 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2019-13136](https://nvd.nist.gov/vuln/detail/CVE-2019-13136) CVSSv3=7.8 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20310](https://nvd.nist.gov/vuln/detail/CVE-2021-20310) CVSSv3=7.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20311](https://nvd.nist.gov/vuln/detail/CVE-2021-20311) CVSSv3=7.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20312](https://nvd.nist.gov/vuln/detail/CVE-2021-20312) CVSSv3=7.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20313](https://nvd.nist.gov/vuln/detail/CVE-2021-20313) CVSSv3=7.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2017-11447](https://nvd.nist.gov/vuln/detail/CVE-2017-11447) CVSSv3=6.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2020-25663](https://nvd.nist.gov/vuln/detail/CVE-2020-25663) CVSSv3=5.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2020-27829](https://nvd.nist.gov/vuln/detail/CVE-2020-27829) CVSSv3=5.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20243](https://nvd.nist.gov/vuln/detail/CVE-2021-20243) CVSSv3=5.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2021-20244](https://nvd.nist.gov/vuln/detail/CVE-2021-20244) CVSSv3=5.5 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2020-27768](https://nvd.nist.gov/vuln/detail/CVE-2020-27768) CVSSv3=3.3 (nixos-21.05, nixos-unstable)
* [ ] [CVE-2020-27769](https://nvd.nist.gov/vuln/detail/CVE-2020-27769) CVSSv3=3.3 (nixos-21.05, nixos-unstable)

## CVE details

### CVE-2016-5841

Integer overflow in MagickCore/profile.c in ImageMagick before 7.0.2-1 allows remote attackers to cause a denial of service (segmentation fault) or possibly execute arbitrary code via vectors involving the offset variable.

### CVE-2018-16328

In ImageMagick before 7.0.8-8, a NULL pointer dereference exists in the CheckEventLogging function in MagickCore/log.c.

### CVE-2018-16329

In ImageMagick before 7.0.8-8, a NULL pointer dereference exists in the GetMagickProperty function in MagickCore/property.c.

### CVE-2019-17547

In ImageMagick before 7.0.8-62, TraceBezier in MagickCore/draw.c has a use-after-free.

### CVE-2019-13136

ImageMagick before 7.0.8-50 has an integer overflow vulnerability in the function TIFFSeekCustomStream in coders/tiff.c.

### CVE-2021-20310

A flaw was found in ImageMagick in versions before 7.0.11, where a division by zero ConvertXYZToJzazbz() of MagickCore/colorspace.c may trigger undefined behavior via a crafted image file that is submitted by an attacker and processed by an application using ImageMagick. The highest threat from this vulnerability is to system availability.

### CVE-2021-20311

A flaw was found in ImageMagick in versions before 7.0.11, where a division by zero in sRGBTransformImage() in the MagickCore/colorspace.c may trigger undefined behavior via a crafted image file that is submitted by an attacker processed by an application using ImageMagick. The highest threat from this vulnerability is to system availability.

### CVE-2021-20312

A flaw was found in ImageMagick in versions 7.0.11, where an integer overflow in WriteTHUMBNAILImage of coders/thumbnail.c may trigger undefined behavior via a crafted image file that is submitted by an attacker and processed by an application using ImageMagick. The highest threat from this vulnerability is to system availability.

### CVE-2021-20313

A flaw was found in ImageMagick in versions before 7.0.11. A potential cipher leak when the calculate signatures in TransformSignature is possible. The highest threat from this vulnerability is to data confidentiality.

### CVE-2017-11447

The ReadSCREENSHOTImage function in coders/screenshot.c in ImageMagick before 7.0.6-1 has memory leaks, causing denial of service.

### CVE-2020-25663

A call to ConformPixelInfo() in the SetImageAlphaChannel() routine of /MagickCore/channel.c caused a subsequent heap-use-after-free or heap-buffer-overflow READ when GetPixelRed() or GetPixelBlue() was called. This could occur if an attacker is able to submit a malicious image file to be processed by ImageMagick and could lead to denial of service. It likely would not lead to anything further because the memory is used as pixel data and not e.g. a function pointer. This flaw affects ImageMagick versions prior to 7.0.9-0.

### CVE-2020-27829

A heap based buffer overflow in coders/tiff.c may result in program crash and denial of service in ImageMagick before 7.0.10-45.

### CVE-2021-20243

A flaw was found in ImageMagick in MagickCore/resize.c. An attacker who submits a crafted file that is processed by ImageMagick could trigger undefined behavior in the form of math division by zero. The highest threat from this vulnerability is to system availability.

### CVE-2021-20244

A flaw was found in ImageMagick in MagickCore/visual-effects.c. An attacker who submits a crafted file that is processed by ImageMagick could trigger undefined behavior in the form of math division by zero. The highest threat from this vulnerability is to system availability.

### CVE-2020-27768

In ImageMagick, there is an outside the range of representable values of type 'unsigned int' at MagickCore/quantum-private.h. This flaw affects ImageMagick versions prior to 7.0.9-0.

### CVE-2020-27769

In ImageMagick versions before 7.0.9-0, there are outside the range of representable values of type 'float' at MagickCore/quantize.c.

-----
Scanned versions: nixos-21.05: 4f37689c8a2; nixos-unstable: 942eb9a335b.

Cc @erictapen

