# Vulnerability roundup 112: firefox-91.7.1esr: 37 advisories [10.0]

[search](https://search.nix.gsc.io/?q=firefox&i=fosho&repos=NixOS-nixpkgs), [files](https://github.com/NixOS/nixpkgs/search?utf8=%E2%9C%93&q=firefox+in%3Apath&type=Code)

* [ ] [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503) CVSSv3=10.0 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38494](https://nvd.nist.gov/vuln/detail/CVE-2021-38494) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38496](https://nvd.nist.gov/vuln/detail/CVE-2021-38496) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38499](https://nvd.nist.gov/vuln/detail/CVE-2021-38499) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38500](https://nvd.nist.gov/vuln/detail/CVE-2021-38500) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38501](https://nvd.nist.gov/vuln/detail/CVE-2021-38501) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38510](https://nvd.nist.gov/vuln/detail/CVE-2021-38510) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43534](https://nvd.nist.gov/vuln/detail/CVE-2021-43534) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43535](https://nvd.nist.gov/vuln/detail/CVE-2021-43535) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539) CVSSv3=8.8 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-29993](https://nvd.nist.gov/vuln/detail/CVE-2021-29993) CVSSv3=8.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38498](https://nvd.nist.gov/vuln/detail/CVE-2021-38498) CVSSv3=7.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38491](https://nvd.nist.gov/vuln/detail/CVE-2021-38491) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38492](https://nvd.nist.gov/vuln/detail/CVE-2021-38492) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38497](https://nvd.nist.gov/vuln/detail/CVE-2021-38497) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38505](https://nvd.nist.gov/vuln/detail/CVE-2021-38505) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43540](https://nvd.nist.gov/vuln/detail/CVE-2021-43540) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545) CVSSv3=6.5 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43530](https://nvd.nist.gov/vuln/detail/CVE-2021-43530) CVSSv3=6.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43532](https://nvd.nist.gov/vuln/detail/CVE-2021-43532) CVSSv3=6.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543) CVSSv3=6.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43544](https://nvd.nist.gov/vuln/detail/CVE-2021-43544) CVSSv3=6.1 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43531](https://nvd.nist.gov/vuln/detail/CVE-2021-43531) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43533](https://nvd.nist.gov/vuln/detail/CVE-2021-43533) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538) CVSSv3=4.3 (nixos-21.11, nixos-unstable)
* [ ] [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546) CVSSv3=4.3 (nixos-21.11, nixos-unstable)

## CVE details

### CVE-2021-38503

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-30547

Out of bounds write in ANGLE in Google Chrome prior to 91.0.4472.101 allowed a remote attacker to potentially perform out of bounds memory access via a crafted HTML page.

### CVE-2021-38493

Mozilla developers reported memory safety bugs present in Firefox 91 and Firefox ESR 78.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox ESR < 78.14, Thunderbird < 78.14, and Firefox < 92.

### CVE-2021-38494

Mozilla developers reported memory safety bugs present in Firefox 91. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox < 92.

### CVE-2021-38496

During operations on MessageTasks, a task may have been removed while it was still scheduled, resulting in memory corruption and a potentially exploitable crash. This vulnerability affects Thunderbird < 78.15, Thunderbird < 91.2, Firefox ESR < 91.2, Firefox ESR < 78.15, and Firefox < 93.

### CVE-2021-38499

Mozilla developers reported memory safety bugs present in Firefox 92. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox < 93.

### CVE-2021-38500

Mozilla developers reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Thunderbird < 78.15, Thunderbird < 91.2, Firefox ESR < 91.2, Firefox ESR < 78.15, and Firefox < 93.

### CVE-2021-38501

Mozilla developers reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox < 93, Thunderbird < 91.2, and Firefox ESR < 91.2.

### CVE-2021-38504

When interacting with an HTML input element's file picker dialog with webkitdirectory set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-38510

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-43534

Mozilla developers and community members reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-43535

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash. This vulnerability affects Firefox < 93, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-43537

An incorrect type conversion of sizes from 64bit to 32bit integers allowed an attacker to corrupt memory leading to a potentially exploitable crash. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43539

Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occurring within the call not tracing those live pointers. This could have led to a use-after-free causing a potentially exploitable crash. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-29993

Firefox for Android allowed navigations through the `intent://` protocol, which could be used to cause crashes and UI spoofs. *This bug only affects Firefox for Android. Other operating systems are unaffected.*. This vulnerability affects Firefox < 92.

### CVE-2021-38498

During process shutdown, a document could have caused a use-after-free of a languages service object, leading to memory corruption and a potentially exploitable crash. This vulnerability affects Firefox < 93, Thunderbird < 91.2, and Firefox ESR < 91.2.

### CVE-2021-38491

Mixed-content checks were unable to analyze opaque origins which led to some mixed content being loaded. This vulnerability affects Firefox < 92.

### CVE-2021-38492

When delegating navigations to the operating system, Firefox would accept the `mk` scheme which might allow attackers to launch pages and execute scripts in Internet Explorer in unprivileged mode. *This bug only affects Firefox for Windows. Other operating systems are unaffected.*. This vulnerability affects Firefox < 92, Thunderbird < 91.1, Thunderbird < 78.14, Firefox ESR < 78.14, and Firefox ESR < 91.1.

### CVE-2021-38497

Through use of reportValidity() and window.open(), a plain-text validation message could have been overlaid on another origin, leading to possible user confusion and spoofing attacks. This vulnerability affects Firefox < 93, Thunderbird < 91.2, and Firefox ESR < 91.2.

### CVE-2021-38505

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account. *This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-38507

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-43536

Under certain circumstances, asynchronous functions could have caused a navigation to fail but expose the target URL. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43540

WebExtensions with the correct permissions were able to create and install ServiceWorkers for third-party websites that would not have been uninstalled with the extension. This vulnerability affects Firefox < 95.

### CVE-2021-43541

When invoking protocol handlers for external protocols, a supplied parameter URL containing spaces was not properly escaped. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43542

Using XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43545

Using the Location API in a loop could have caused severe application hangs and crashes. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43530

A Universal XSS vulnerability was present in Firefox for Android resulting from improper sanitization when processing a URL scanned from a QR code. *This bug only affects Firefox for Android. Other operating systems are unaffected.*. This vulnerability affects Firefox < 94.

### CVE-2021-43532

The 'Copy Image Link' context menu action would copy the final image URL after redirects. By embedding an image that triggered authentication flows - in conjunction with a Content Security Policy that stopped a redirection chain in the middle - the final image URL could be one that contained an authentication token used to takeover a user account. If a website tricked a user into copy and pasting the image link back to the page, the page would be able to steal the authentication tokens. This was fixed by making the action return the original URL, before any redirects. This vulnerability affects Firefox < 94.

### CVE-2021-43543

Documents loaded with the CSP sandbox directive could have escaped the sandbox's script restriction by embedding additional content. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43544

When receiving a URL through a SEND intent, Firefox would have searched for the text, but subsequent usages of the address bar might have caused the URL to load unintentionally, which could lead to XSS and spoofing attacks. *This bug only affects Firefox for Android. Other operating systems are unaffected.*. This vulnerability affects Firefox < 95.

### CVE-2021-38506

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-38508

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-38509

Due to an unusual sequence of attacker-controlled events, a Javascript alert() dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing. This vulnerability affects Firefox < 94, Thunderbird < 91.3, and Firefox ESR < 91.3.

### CVE-2021-43531

When a user loaded a Web Extensions context menu, the Web Extension could access the post-redirect URL of the element clicked. If the Web Extension lacked the WebRequest permission for the hosts involved in the redirect, this would be a same-origin-violation leaking data the Web Extension should have access to. This was fixed to provide the pre-redirect URL. This is related to CVE-2021-43532 but in the context of Web Extensions. This vulnerability affects Firefox < 94.

### CVE-2021-43533

When parsing internationalized domain names, high bits of the characters in the URLs were sometimes stripped, resulting in inconsistencies that could lead to user confusion or attacks such as phishing. This vulnerability affects Firefox < 94.

### CVE-2021-43538

By misusing a race in our notification code, an attacker could have forcefully hidden the notification for pages that had received full screen and pointer lock access, which could have been used for spoofing attacks. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

### CVE-2021-43546

It was possible to recreate previous cursor spoofing attacks against users with a zoomed native cursor. This vulnerability affects Thunderbird < 91.4.0, Firefox ESR < 91.4.0, and Firefox < 95.

-----
Scanned versions: nixos-21.11: efea022d6fe; nixos-unstable: 710fed5a248.

Cc @mweinelt

