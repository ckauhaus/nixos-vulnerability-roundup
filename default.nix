{ pkgs ? import <nixpkgs> {} }:

let
  # needs at least rustc 1.30, so don't try this with NixOS 18.09 or older
  survey = pkgs.rustPlatform.buildRustPackage rec {
    name = "survey-${version}";
    version = "0.1.2";
    src = pkgs.lib.cleanSource ./survey;
    cargoSha256 = "1gxg009dkqkhfkqmlqg05rk2djxq5smz1ljfjgfjnnz112gkb01v";
  };

in pkgs.buildEnv {
  name = "vulnerability-roundup-env";
  paths = [ survey pkgs.vulnix ];
  pathsToLink = [ "/bin" "/share" ];
}
